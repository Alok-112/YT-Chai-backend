# Complete Data Modeling Guide with Mongoose -

## Key Learning: Fresher vs Experienced Developer Approach

### **Fresher Approach (❌ Not Recommended)**
- Starts making models and controllers immediately at project start
- Jumps into coding without proper planning
- No data modeling strategy

### **Experienced Approach (✅ Recommended)**
- Plans data structure first
- Identifies what data needs to be stored
- Creates proper data models before controllers

---

## Step 1: Data Planning - What Data Are We Storing?

### **Important Questions to Ask:**
Before writing any code, identify your data points:

- **User Information**: Email ID, username, password
- **Media Files**: Photos, videos (and their formats)
- **Contact Information**: Phone numbers, addresses
- **Content Data**: Text, descriptions, titles
- **Metadata**: Creation dates, update times, status flags

### **Data Format Considerations:**
- **Strings**: Text data (emails, usernames, descriptions)
- **Numbers**: IDs, counts, ratings
- **Booleans**: Status flags (complete/incomplete, active/inactive)
- **Dates**: Creation time, update time
- **Arrays**: Lists of related items
- **ObjectIds**: References to other documents

---

## Professional Tools for Data Modeling

### **Mongoose Moon Modeler**
- Professional tool for creating Mongoose models
- Compatible with Mongoose syntax
- Used by big tech companies

### **Industry Practice:**
- Large companies have **dedicated data specialists**
- Separate role from backend developers
- Data modeling is a specialized skill

### **Quick Planning Tool:**
- Use **eraser.io** for visual planning
- Start with pen and paper for first-time modeling
- Create screens/wireframes before coding

---

## Mongoose Documentation
- Official docs: https://mongoosejs.com/
- **Warning**: Don't start by reading docs randomly - you won't understand
- Better to learn through examples and practical implementation

---

## Practical Example: Todo App Data Models

### **Project Structure:**
```
models/
  todos/
    todo.models.js
    user.models.js
    sub_todo.models.js
```

---

## Model 1: User Model

```javascript
import mongoose from 'mongoose'

const userSchema = new mongoose.Schema({
    username: {
        type: String,
        required: true,
        unique: true,
        lowercase: true
    },
    email: {
        type: String,
        required: true,
        unique: true,
        lowercase: true
    },
    password: {
        type: String,
        required: true
    }
}, {
    timestamps: true
})

export const User = mongoose.model("User", userSchema)
```

### **Key Points:**
- **Object Syntax vs Simple**: `username: String` vs `username: { type: String, ... }`
- **Object syntax unlocks Mongoose's real power**
- **Available Options:**
  - `required: true` - Field is mandatory
  - `unique: true` - No duplicates allowed
  - `lowercase: true` - Automatically converts to lowercase
- **Custom Error Messages**: `required` can accept an array with custom messages
- **Timestamps**: Automatically adds `createdAt` and `updatedAt` fields

---

## Model 2: Todo Model

```javascript
import mongoose from 'mongoose'

const todoSchema = new mongoose.Schema({
    content: {
        type: String,
        required: true
    },
    complete: {
        type: Boolean,
        default: false
    },
    createdBy: {
        type: mongoose.Schema.Types.ObjectId,
        ref: "User"
    },
    subTodos: [
        {
            type: mongoose.Schema.Types.ObjectId,
            ref: "SubTodo"
        }
    ] // Array of subtodos
}, {
    timestamps: true
})

export const Todo = mongoose.model("Todo", todoSchema)
```

### **Key Points:**
- **Content**: Main todo text
- **Complete**: Boolean with default value
- **CreatedBy**: Reference to User who created it
- **SubTodos**: Array of references to SubTodo documents

---

## Model 3: SubTodo Model

```javascript
import mongoose from 'mongoose'

const subTodoSchema = new mongoose.Schema({
    content: {
        type: String,
        required: true
    },
    complete: {
        type: Boolean,
        default: false
    },
    createdBy: {
        type: mongoose.Schema.Types.ObjectId,
        ref: "User"
    }
}, {
    timestamps: true
})

export const SubTodo = mongoose.model("SubTodo", subTodoSchema)
```

---

## Understanding MongoDB Relations

### **ObjectId References:**
```javascript
type: mongoose.Schema.Types.ObjectId,
ref: "User"
```

### **What This Means:**
- **ObjectId**: MongoDB's unique identifier type
- **ref**: References another model/collection
- **Must match exactly**: The ref name must match your model name
- **Enables Population**: Later you can use `.populate()` to get full user data

### **Relationship Types:**
- **One-to-One**: User has one profile
- **One-to-Many**: User has many todos
- **Many-to-Many**: Users can share todos

---

## Important Schema Options Explained

### **Timestamps Object:**
```javascript
{
    timestamps: true
}
```
**What it does:**
- Automatically adds `createdAt` field
- Automatically adds `updatedAt` field
- Updates `updatedAt` every time document is modified

### **Required Field with Custom Messages:**
```javascript
username: {
    type: String,
    required: [true, 'Username is required']
}
```

### **Array of References:**
```javascript
subTodos: [
    {
        type: mongoose.Schema.Types.ObjectId,
        ref: "SubTodo"
    }
]
```
**Creates:** An array that can hold multiple SubTodo references

---

## Best Practices Summary

1. **Plan First**: Always identify your data before coding
2. **Use Objects**: Leverage Mongoose's full power with object syntax
3. **References**: Use ObjectId references for relationships
4. **Timestamps**: Always include timestamps for tracking
5. **Validation**: Use required, unique, and other validators
6. **Naming**: Keep model names consistent with ref names
7. **Structure**: Organize models in separate files
8. **Documentation**: Comment complex relationships

---

## Common Mistakes to Avoid

❌ **Wrong Model Reference:**
```javascript
export const User = mongoose.model("Use", userSchema) // Typo!
```

❌ **Missing Ref:**
```javascript
createdBy: {
    type: mongoose.Schema.Types.ObjectId
    // Missing ref: "User"
}
```

❌ **Syntax Errors:**
```javascript
const todoSchema = new mongoose.Schema{{ // Double braces!
```

✅ **Correct Approach:**
- Always double-check model names
- Include proper references
- Use correct syntax
- Test your models before building controllers